#
# This file allows to build source and binary RPM packages
#
# How to build :
#   - Run './configure' (without options)
#   - Then, run 'make rpm'
#
#==============================================================================
#
# @configure_input@
#
Name: @PACKAGE_NAME@
Summary: @PACKAGE_SUMMARY@
Version: @PACKAGE_VERSION@
Release: @RELEASE_NUMBER@
License: @PACKAGE_LICENSE@
Source: @PACKAGE_NAME@-%{version}.tar.gz
URL: http://@PACKAGE_NAME@.tekwire.net/
Prefix: %{_prefix}
BuildRoot: %{_tmppath}/%{name}-%{version}-root
Packager: @PACKAGE_AUTHOR@
AutoReqProv: no
Group: System Environment/Configuration
BuildArch: @ARCHITECTURE@

%if 0%{?suse_version}
BuildRequires: @RPM_BUILD_DEPS@
# OBS needs rpmlintrc to ignore errors
Source99: @PACKAGE_NAME@-rpmlintrc  
%else
BuildRequires: @RPM_BUILD_DEPS@
Provides: @PACKAGE_NAME@
%endif

%description
@PACKAGE_SUMMARY@

# Fake changelog info
%changelog
* Mon Jan 01 2011 @PACKAGE_AUTHOR@
For changelog information, please consult http://@PACKAGE_NAME@.hg.sourceforge.net/hgweb/@PACKAGE_NAME@/@PACKAGE_NAME@/log

%prep
%setup -q
# %__chmod 0644 ACKNOWLEDGEMENTS AUTHORS ChangeLog COPYING NEWS NOTICE README TODO  

%build
# On OBS, run autotools because installed versions can be
# incompatible with the version we ran to generate the distrib.
# Unfortunately, OBS uses two different strings for the 'vendor' macro
in_obs=''
echo '%vendor' | grep '^obs://build.opensuse.org/' && in_obs=y
[ '%vendor' = 'openSUSE Build Service' ] && in_obs=y
if [ -n "$in_obs" ] ; then
	build/buildconf --verbose
fi
%configure
make

%check
make check

%install
rm -rf "%{buildroot}"
mkdir "%{buildroot}"
%makeinstall

%clean
rm -rf "%{buildroot}"

%files
%defattr(-,root,root,-)
%doc ACKNOWLEDGEMENTS AUTHORS ChangeLog COPYING NEWS NOTICE README TODO doc/@PACKAGE_NAME@_api.phk doc/@PACKAGE_NAME@_api.pdf doc/@PACKAGE_NAME@_xref.phk
%{_libexecdir}/@PACKAGE_NAME@.phk
